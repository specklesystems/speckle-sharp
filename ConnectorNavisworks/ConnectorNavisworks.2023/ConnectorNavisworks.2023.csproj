<?xml version="1.0" encoding="utf-8"?>

<Project Sdk="Microsoft.NET.Sdk.WindowsDesktop">

	<!-- Project Config -->
	<PropertyGroup>
		<Title>SpeckleConnectorNavisworks</Title>
		<AssemblyName>SpeckleConnectorNavisworks</AssemblyName>
		<RootNamespace>Speckle.ConnectorNavisworks</RootNamespace>
		<ProjectGuid>{74E39841-B2FA-494D-AC40-A6E505DE6B33}</ProjectGuid>
		<Version>0.1.0</Version>
		
		<TargetFramework>net48</TargetFramework>
		<PlatformTarget>x64</PlatformTarget>
		<RuntimeIdentifier>win-x64</RuntimeIdentifier>
		<FileAlignment>512</FileAlignment>
		<Deterministic>true</Deterministic>

		<Description>Speckle writer for Autodesk Navisworks Manage</Description>
		<Authors>jonathon@speckle.systems</Authors>
		<Company>Speckle</Company>
		
		<RepositoryUrl>https://github.com/jsdbroughton/speckle-navis</RepositoryUrl>
		<RepositoryType>git</RepositoryType>
		<PackageTags>speckle connector nwd nwc nwf navisworks manage</PackageTags>
		
		<UseWindowsForms>true</UseWindowsForms>
		<OutputType>Library</OutputType>
		<AppDesignerFolder>Properties</AppDesignerFolder>
		<Configurations>Debug;Release</Configurations>

		<NavisworksBuildNumber>v20</NavisworksBuildNumber>
		<NavisworksApiPath>..\..\..\..\..\..\..\..\Program Files\Autodesk\Navisworks Manage 2023</NavisworksApiPath>
		<PluginBundleTarget>C:\ProgramData\Autodesk\ApplicationPlugins\Speckle.ConnectorNavisworks.bundle</PluginBundleTarget>
		<!--<Platforms>AnyCPU;x64</Platforms>-->
	</PropertyGroup>

	<!-- Avalonia -->

	<!-- Speckle Specific -->

	<!-- Configurations -->
	<PropertyGroup Condition=" '$(Configuration)' == 'Debug' ">
		<OutputPath>bin\x64\Debug\</OutputPath>
		<DefineConstants>$(DefineConstants);NAVMAN20</DefineConstants>
		<DebugSymbols>true</DebugSymbols>
		<DebugType>full</DebugType>
		<Optimize>false</Optimize>
		<ErrorReport>prompt</ErrorReport>
		<WarningLevel>4</WarningLevel>
	</PropertyGroup>
	<PropertyGroup Condition=" '$(Configuration)' == 'Release' ">
		<OutputPath>bin\x64\Release\</OutputPath>
		<DefineConstants>$(DefineConstants);NAVMAN20</DefineConstants>
		<DebugType>pdbonly</DebugType>
		<Optimize>true</Optimize>
		<ErrorReport>prompt</ErrorReport>
		<WarningLevel>4</WarningLevel>
	</PropertyGroup>

	<!-- Includes -->
	<Import Project="..\ConnectorNavisworks\ConnectorNavisworks.Shared.projitems" Label="Shared" />

	<!-- Post Builds -->
	<PropertyGroup>
		<PostBuildEvent>
			@echo off
			echo Check for existing bundle build
			IF EXIST "$(PluginBundleTarget)\Contents\$(NavisworksBuildNumber)" (
			echo $(PluginBundleTarget)\Contents\$(NavisworksBuildNumber)\ exists
			echo Remove Existing Bundle Build
			rmdir /S /Q "$(PluginBundleTarget)\Contents\$(NavisworksBuildNumber)"
			)

			echo(
			echo Write Plugin DLL
			xcopy /Y "$(TargetPath)" "$(PluginBundleTarget)\Contents\$(NavisworksBuildNumber)\"

			echo(
			echo Package Content File
			xcopy /Y "$(TargetDir)Entry\PackageContents.xml" "$(PluginBundleTarget)\"

			echo(
			echo Copy UI Resources
			mkdir "$(PluginBundleTarget)\Contents\$(NavisworksBuildNumber)\en-US
			copy /Y "$(TargetDir)Entry\Ribbon.xaml" "$(PluginBundleTarget)\Contents\$(NavisworksBuildNumber)\en-US\"
			copy /Y "$(TargetDir)Entry\Ribbon.name" "$(PluginBundleTarget)\Contents\$(NavisworksBuildNumber)\en-US\"

			echo(
			echo Copy Resources
			mkdir "$(PluginBundleTarget)\Contents\$(NavisworksBuildNumber)\Resources
			copy /Y "$(TargetDir)Resources\*.*" "$(PluginBundleTarget)\Contents\$(NavisworksBuildNumber)\Resources\"

			echo(
			echo Copy Dependencies
			xcopy /Y "$(TargetDir)*.dll" "$(PluginBundleTarget)\Contents\$(NavisworksBuildNumber)\"
		</PostBuildEvent>
	</PropertyGroup>

	<!-- NUGETS -->
	<ItemGroup>
	  <PackageReference Include="Colorful.Console" Version="1.2.15" />
	</ItemGroup>

	<!--- Local Project Dependencies -->
	<ItemGroup>
	  <ProjectReference Include="..\..\Core\Core\Core.csproj" />
	  <ProjectReference Include="..\..\DesktopUI2\DesktopUI2\DesktopUI2.csproj" />
	</ItemGroup>

	<!-- References -->
	<ItemGroup>
		<Reference Include="AdWindows">
			<HintPath>$(NavisworksApiPath)\AdWindows.dll</HintPath>
			<Private>False</Private>
			<Aliases>global</Aliases>
			<EmbedInteropTypes>False</EmbedInteropTypes>
		</Reference>
		<Reference Include="Autodesk.Navisworks.Api">
			<HintPath>$(NavisworksApiPath)\Autodesk.Navisworks.Api.dll</HintPath>
			<Private>False</Private>
		</Reference>
		<Reference Include="Autodesk.Navisworks.Clash">
			<HintPath>$(NavisworksApiPath)\Autodesk.Navisworks.Clash.dll</HintPath>
			<Private>True</Private>
		</Reference>
		<Reference Include="Autodesk.Navisworks.ComApi">
			<HintPath>$(NavisworksApiPath)\Autodesk.Navisworks.ComApi.dll</HintPath>
			<Private>False</Private>
		</Reference>
		<Reference Include="Autodesk.Navisworks.Controls">
			<HintPath>$(NavisworksApiPath)\Autodesk.Navisworks.Controls.dll</HintPath>
			<Private>False</Private>
		</Reference>
		<Reference Include="Autodesk.Navisworks.Interop.ComApi">
			<HintPath>$(NavisworksApiPath)\Autodesk.Navisworks.Interop.ComApi.dll</HintPath>
			<Private>False</Private>
		</Reference>
		<Reference Include="AvaloniaHwndHost">
		  <HintPath>..\..\DesktopUI2\AvaloniaHwndHost\bin\Debug\net48\AvaloniaHwndHost.dll</HintPath>
		</Reference>
		<Reference Include="navisworks.gui.common">
			<HintPath>$(NavisworksApiPath)\navisworks.gui.common.dll</HintPath>
			<Private>False</Private>
		</Reference>
		<Reference Include="navisworks.gui.interface">
			<HintPath>$(NavisworksApiPath)\navisworks.gui.interface.dll</HintPath>
			<Private>False</Private>
		</Reference>
		<Reference Include="navisworks.gui.roamer">
			<HintPath>$(NavisworksApiPath)\navisworks.gui.roamer.dll</HintPath>
			<Private>False</Private>
		</Reference>
		<Reference Include="System.ComponentModel.Composition">
		  <Private>False</Private>
		</Reference>
		<Reference Include="System.ComponentModel.Composition.Registration">
		  <Private>False</Private>
		</Reference>
		<Reference Include="System.Data.DataSetExtensions">
		  <Private>False</Private>
		</Reference>
		<Reference Include="System.Windows.Controls.Ribbon">
		  <Private>False</Private>
		</Reference>
		<Reference Include="System.Xaml">
		  <Private>False</Private>
		</Reference>
		<Reference Include="System.Xml.Serialization">
			<Private>False</Private>
		</Reference>
		<Reference Include="PresentationCore">
			<Private>False</Private>
		</Reference>
		<Reference Include="PresentationFramework">
			<Private>False</Private>
		</Reference>
		<Reference Include="UIAutomationProvider">
		  <Private>False</Private>
		</Reference>
		<Reference Include="WindowsFormsIntegration">
		  <Private>False</Private>
		</Reference>
		<Reference Update="System">
			<Private>False</Private>
			<EmbedInteropTypes>False</EmbedInteropTypes>
			<Aliases>global</Aliases>
		</Reference>
		<Reference Update="System.Core">
			<Private>False</Private>
		</Reference>
		<Reference Update="System.Data">
			<Private>False</Private>
		</Reference>
		<Reference Update="System.Drawing">
			<Private>False</Private>
		</Reference>
		<Reference Update="System.IO.Compression.FileSystem">
			<Private>False</Private>
		</Reference>
		<Reference Update="System.Numerics">
			<Private>False</Private>
		</Reference>
		<Reference Update="System.Runtime.Serialization">
			<Private>False</Private>
		</Reference>
		<Reference Update="System.Windows.Forms">
			<Private>False</Private>
		</Reference>
		<Reference Update="System.Xml">
			<Private>False</Private>
		</Reference>
		<Reference Update="System.Xml.Linq">
			<Private>False</Private>
		</Reference>
	</ItemGroup>
</Project>