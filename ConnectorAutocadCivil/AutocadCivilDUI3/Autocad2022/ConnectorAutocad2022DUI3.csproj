<Project Sdk="Microsoft.NET.Sdk">
    <PropertyGroup>
        <RootNamespace>Speckle.ConnectorAutocadDUI3</RootNamespace>
        <AssemblyName>ConnectorAutocadDUI3</AssemblyName>
        <UseWPF>true</UseWPF>
        <TargetFramework>net48</TargetFramework>
        <StartAction>Program</StartAction>
        <StartProgram>$(ProgramW6432)\Autodesk\AutoCAD 2022\acad.exe</StartProgram>
        <PlatformTarget>x64</PlatformTarget>
        <AssemblyTitle>ConnectorAutocad2022DUI3</AssemblyTitle>
        <Product>ConnectorAutocad2022DUI3</Product>
        <DefineConstants>$(DefineConstants);AUTOCAD2022DUI3</DefineConstants>
        <AppendTargetFrameworkToOutputPath>false</AppendTargetFrameworkToOutputPath>
    </PropertyGroup>
    
    <Target Name="Clean">
        <RemoveDir Directories="$(TargetDir);$(AppData)\Autodesk\ApplicationPlugins\Speckle2AutoCAD2022DUI3" />
    </Target>
    <Target Name="AfterBuildMigrated" AfterTargets="PostBuildEvent" Condition="$([MSBuild]::IsOsPlatform('Windows'))">
        <Message Text="Calling 2022 post build" Importance="high" />
        <CallTarget Condition="'$(Configuration)' == 'Debug' AND '$(IsDesktopBuild)' == true" Targets="AfterBuildDebug" />
    </Target>
    <Target Name="AfterBuildDebug">
        <ItemGroup>
            <SourceDLLs Include="$(TargetDir)\**\*.*" />
        </ItemGroup>
        <Copy DestinationFolder="$(AppData)\Autodesk\ApplicationPlugins\Speckle2AutoCAD2022DUI3\%(RecursiveDir)" SourceFiles="@(SourceDLLs)" />
    </Target>

    <ItemGroup>
        <PackageReference Include="Microsoft.Web.WebView2" Version="1.0.1823.32" />
        <PackageReference Include="Speckle.AutoCAD.API" Version="2022.0.2" IncludeAssets="compile; build" PrivateAssets="all" />
    </ItemGroup>

    <ItemGroup>
      <ProjectReference Include="..\..\..\Core\Core\Core.csproj" />
      <ProjectReference Include="..\..\..\DesktopUI3\DUI3\DUI3.csproj" />
    </ItemGroup>

    <ItemGroup>
      <Reference Include="PresentationCore" />
      <Reference Include="PresentationFramework" />
      <Reference Include="System.Xaml" />
      <Reference Include="WindowsFormsIntegration">
        <HintPath>..\..\..\..\..\..\..\..\Windows\Microsoft.NET\assembly\GAC_MSIL\WindowsFormsIntegration\v4.0_4.0.0.0__31bf3856ad364e35\WindowsFormsIntegration.dll</HintPath>
      </Reference>
    </ItemGroup>

    <Import Project="..\AutocadCivilDUI3Shared\AutocadCivilDUI3Shared.projitems" Label="Shared" />
</Project>
